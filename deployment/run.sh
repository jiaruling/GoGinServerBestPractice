#!/bin/bash

echo "------------------------------------------------ define variable----------------------------------------------------"
lastedVersion="v16.0"
version="v17.0"

echo "------------------------------------------------ build docker ----------------------------------------------------"
docker build -t gm-hcg:$version .

echo "------------------------------------------------  delete current continer ----------------------------------------------------"
docker rm -f gm-hcg-$lastedVersion

echo "------------------------------------------------ run docker ------------------------------------------------------"
docker run -d -e GM_HCG=$version --name=gm-hcg-$version -p 8085:8085 gm-hcg:$version

echo " ---------------------------------------------------- request health interface ----------------------------------------------------"
curl "http://127.0.0.1:8085/health"